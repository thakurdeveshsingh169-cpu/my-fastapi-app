<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<title>Desh AI Human</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{

  background:white;

  display:flex;

  justify-content:center;

  align-items:center;

  height:100vh;

  margin:0;

  font-family:Arial, sans-serif;

  user-select:none;

}

/* ================= FACE ================= */

.human{ position:relative; width:260px; height:360px; }

.hair{

  position:absolute; top:0; width:100%; height:95px;

  background:#111; border-radius:130px 130px 60px 60px; z-index:5;

}

.face{

  position:absolute; top:55px; width:100%; height:280px;

  background:#f1c9a5; border-radius:130px;

}

.ear{

  position:absolute; top:120px; width:28px; height:50px;

  background:#f1c9a5; border-radius:50%;

}

.ear.left{ left:-20px; }

.ear.right{ right:-20px; }

.eye{

  position:absolute; top:90px; width:32px; height:18px;

  background:white; border-radius:50%; overflow:hidden;

  animation: blink 1.5s infinite;

}

.eye.left{ left:65px; }

.eye.right{ right:65px; }

.pupil{

  position:absolute; width:10px; height:10px;

  background:#000; border-radius:50%;

  top:4px; left:11px;

}

@keyframes blink{

  0%,96%,100%{ height:18px; }

  97%,99%{ height:2px; }

}

.nose{

  position:absolute; top:135px; left:50%;

  transform:translateX(-50%);

  width:16px; height:24px;

  background:#e0b08c; border-radius:10px;

}

.mouth{

  position:absolute; bottom:70px; left:50%;

  transform:translateX(-50%);

  width:80px; height:14px;

  background:#600; border-radius:0 0 40px 40px;

  overflow:hidden;

  transition:height 0.3s ease-in-out;

}

.mouth.open{ height:34px; }

.teeth{

  position:absolute; top:0; width:100%; height:14px;

  background:#fff; border-bottom:2px solid #ccc;

}

.tongue{

  position:absolute; bottom:2px; left:50%;

  transform:translateX(-50%);

  width:36px; height:16px;

  background:#d66; border-radius:50%;

}

/* ================= NEON BUTTON ================= */

#neonBtn{

  position:fixed;

  bottom:20px;

  left:20px;

  width:60px;

  height:60px;

  border-radius:50%;

  border:none;

  cursor:pointer;

  background:#00faff;

  box-shadow: 0 0 15px #00faff;

  transition:0.3s;

}

#neonBtn.on{

  background:#ff2d2d;

  box-shadow:

    0 0 10px #ff2d2d,

    0 0 25px #ff2d2d,

    0 0 50px #ff2d2d;

  animation:pulse 1.5s infinite;

}

@keyframes pulse{

  0%{ box-shadow:0 0 10px #ff2d2d; }

  50%{ box-shadow:0 0 40px #ff2d2d; }

  100%{ box-shadow:0 0 10px #ff2d2d; }

}

</style>

</head>

<body>

<div class="human">

  <div class="hair"></div>

  <div class="face">

    <div class="ear left"></div>

    <div class="ear right"></div>

    <div class="eye left"><div class="pupil"></div></div>

    <div class="eye right"><div class="pupil"></div></div>

    <div class="nose"></div>

    <div class="mouth" id="mouth">

      <div class="teeth"></div>

      <div class="tongue"></div>

    </div>

  </div>

</div>

<button id="neonBtn"></button>

<script>

let recognition, synth;

let speaking=false, active=false;

const mouth=document.getElementById("mouth");

const btn=document.getElementById("neonBtn");

btn.onclick=()=>{

  active=!active;

  btn.classList.toggle("on",active);

  if(active) startAI();

  else stopAI();

};

function cleanText(t){

  return t.replace(/[\p{Emoji_Presentation}\p{Extended_Pictographic}]/gu,"");

}

function startAI(){

  synth=window.speechSynthesis;

  const SR=window.SpeechRecognition||window.webkitSpeechRecognition;

  recognition=new SR();

  recognition.continuous=true;

  recognition.lang="auto";

  recognition.onresult=async(e)=>{

    if(!active) return;

    const text=e.results[e.results.length-1][0].transcript.trim();

    if(!text) return;

    if(speaking) synth.cancel();

    try{

      const res=await fetch("https://desh-ai.onrender.com/ask",{

        method:"POST",

        headers:{ "Content-Type":"application/json" },

        body:JSON.stringify({ question:text })

      });

      const data=await res.json();

      speak(cleanText(data.answer||"I did not understand"));

    }catch{

      speak("Network error");

    }

  };

  recognition.onend=()=>{ if(active&&!speaking) recognition.start(); };

  recognition.start();

}

function stopAI(){

  if(recognition) recognition.stop();

  if(synth) synth.cancel();

  speaking=false;

  mouth.classList.remove("open");

}

function speak(text){

  const u=new SpeechSynthesisUtterance(text);

  const voices=synth.getVoices();

  u.voice=voices.find(v=>v.lang.startsWith("en")||v.lang.startsWith("hi"))||voices[0];

  u.rate=1.25;
  utter.pitch = 0.8;

  u.onstart=()=>{

    speaking=true;

    lip();

  };

  u.onend=()=>{

    speaking=false;

    mouth.classList.remove("open");

    if(active) recognition.start();

  };

  synth.speak(u);

}

function lip(){

  if(!speaking) return;

  mouth.classList.toggle("open");

  setTimeout(lip,350);

}

</script>

</body>

</html>