<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Hand Cricket</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;900&display=swap');
        body { font-family: 'Outfit', sans-serif; touch-action: manipulation; overflow: hidden; background: #020617; }
        .stadium-bg { background: radial-gradient(circle at bottom, #1e293b 0%, #020617 80%); }
        @keyframes cheer {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(-5deg); }
            75% { transform: translateY(-20px) rotate(5deg); }
        }
        .cheer-anim { animation: cheer 0.4s ease-in-out 3; }
        .number-shuffler { font-variant-numeric: tabular-nums; }
    </style>
</head>
<body class="stadium-bg text-white min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Audio Elements (Placeholders for your mp3 files) -->
    <audio id="snd-normal" loop src="normal.mp3"></audio>
    <audio id="snd-click" src="click.mp3"></audio>
    <audio id="snd-toss" src="toss.mp3"></audio>
    <audio id="snd-ai" src="ai.mp3"></audio>
    <audio id="snd-wicket" src="wicket.mp3"></audio>
    <audio id="snd-boundary" src="boundary.mp3"></audio>

    <!-- Initial Overlay -->
    <div id="screen-start" class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-md">
        <div class="text-center p-8 bg-slate-900 border border-slate-700 rounded-[2rem] shadow-2xl max-w-xs w-full">
            <h1 class="text-3xl font-black mb-6 text-blue-400">READY TO PLAY?</h1>
            <button onclick="initAudioAndStart()" class="w-full bg-blue-600 py-4 rounded-2xl text-xl font-black shadow-lg hover:bg-blue-500 transition active:scale-95">YES, START!</button>
        </div>
    </div>

    <!-- Main Menu -->
    <div id="screen-menu" class="hidden w-full max-w-md p-8 rounded-[2rem] bg-slate-900/80 border border-slate-700 backdrop-blur-xl text-center">
        <h1 class="text-5xl font-black mb-2 tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-indigo-500">ELITE CRICKET</h1>
        <p class="text-slate-400 mb-8 text-sm italic">Pattern Recognition AI Active</p>
        <div class="space-y-6">
            <div class="grid grid-cols-3 gap-3">
                <button onclick="setOvers(2)" class="over-btn p-4 rounded-2xl border border-slate-700 bg-slate-800/50 hover:border-blue-500 transition-all">
                    <span class="block text-xl font-black">2</span>
                    <span class="text-[10px] text-slate-500">OVERS</span>
                </button>
                <button onclick="setOvers(5)" class="over-btn p-4 rounded-2xl border-2 border-blue-500 bg-blue-500/20 shadow-[0_0_15px_rgba(59,130,246,0.3)]">
                    <span class="block text-xl font-black">5</span>
                    <span class="text-[10px] text-slate-500">OVERS</span>
                </button>
                <button onclick="setOvers(10)" class="over-btn p-4 rounded-2xl border border-slate-700 bg-slate-800/50 hover:border-blue-500 transition-all">
                    <span class="block text-xl font-black">10</span>
                    <span class="text-[10px] text-slate-500">OVERS</span>
                </button>
            </div>
            <button onclick="handleMenuPlay()" class="w-full bg-blue-600 py-5 rounded-2xl text-xl font-black shadow-xl transition active:scale-95">PLAY MATCH</button>
        </div>
    </div>

    <!-- Toss Screen -->
    <div id="screen-toss" class="hidden w-full max-w-md bg-slate-900/90 p-8 rounded-[2rem] text-center border border-slate-700">
        <h2 class="text-3xl font-black mb-8 italic">THE TOSS</h2>
        <div class="flex justify-around mb-8">
            <button onclick="handleToss('Heads')" class="w-28 h-28 rounded-full bg-slate-800 border-4 border-yellow-500 text-4xl shadow-xl active:scale-90 transition">ü™ô</button>
            <button onclick="handleToss('Tails')" class="w-28 h-28 rounded-full bg-slate-800 border-4 border-slate-600 text-4xl shadow-xl active:scale-90 transition">ü™ô</button>
        </div>
        <div id="toss-status" class="text-blue-400 font-bold italic h-6"></div>
    </div>

    <!-- Choice Screen -->
    <div id="screen-choice" class="hidden w-full max-w-md bg-slate-900/90 p-8 rounded-[2rem] text-center border border-slate-700">
        <h2 class="text-3xl font-black mb-8">YOU WON!</h2>
        <div class="grid grid-cols-2 gap-4">
            <button onclick="setRole('Batting')" class="bg-blue-600 py-6 rounded-2xl font-black text-2xl">BAT</button>
            <button onclick="setRole('Bowling')" class="bg-slate-700 py-6 rounded-2xl font-black text-2xl">BOWL</button>
        </div>
    </div>

    <!-- Gameplay -->
    <div id="screen-game" class="hidden w-full max-w-md">
        <div class="flex justify-center mb-4 h-24">
            <div id="cheer-container" class="relative opacity-0 transition-opacity duration-300">
                <svg width="80" height="80" viewBox="0 0 100 100" id="humanoid">
                    <circle cx="50" cy="20" r="10" fill="white"/>
                    <path d="M50 30 L50 60 M50 35 L20 20 M50 35 L80 20 M50 60 L30 90 M50 60 L70 90" stroke="white" stroke-width="6" stroke-linecap="round"/>
                </svg>
                <div id="cheer-bubble" class="absolute -top-10 -right-10 bg-white text-black px-3 py-1 rounded-full text-xs font-black">SIXER!</div>
            </div>
        </div>

        <div class="bg-slate-900/90 p-5 rounded-[2rem] border border-slate-700 mb-4 relative overflow-hidden">
            <div id="ai-alert" class="absolute top-0 left-0 w-full bg-red-600 text-[10px] font-bold text-center py-1 transform -translate-y-full transition-transform">AI PATTERN LOCKED</div>
            <div class="flex justify-between items-center">
                <div>
                    <div id="role-badge" class="inline-block px-2 py-0.5 rounded text-[10px] font-black bg-blue-600 mb-1">BATTING</div>
                    <div id="score-text" class="text-4xl font-black">0 <span class="text-xl text-slate-500">/ 0</span></div>
                    <div id="target-text" class="text-[10px] text-yellow-500 font-bold"></div>
                </div>
                <div class="text-right">
                    <div class="text-[10px] text-slate-500 font-bold uppercase">Wickets Left</div>
                    <div id="wickets-text" class="text-2xl font-black text-red-500">5</div>
                    <div id="overs-text" class="text-sm font-bold">0.0 / 5</div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-slate-900 border border-slate-700 p-6 rounded-3xl text-center">
                <p class="text-[10px] font-black text-slate-500 uppercase mb-2">You</p>
                <div id="user-hand" class="text-6xl font-black h-16 flex items-center justify-center number-shuffler">?</div>
            </div>
            <div id="ai-card" class="bg-slate-900 border border-slate-700 p-6 rounded-3xl text-center transition-all">
                <p class="text-[10px] font-black text-slate-500 uppercase mb-2">AI</p>
                <div id="ai-hand" class="text-6xl font-black h-16 flex items-center justify-center">?</div>
            </div>
        </div>

        <div id="input-grid" class="grid grid-cols-5 gap-2">
            <button onclick="handlePlay(1)" class="bg-slate-800 h-16 rounded-2xl text-2xl font-black hover:bg-blue-600 active:scale-90 transition">1</button>
            <button onclick="handlePlay(2)" class="bg-slate-800 h-16 rounded-2xl text-2xl font-black hover:bg-blue-600 active:scale-90 transition">2</button>
            <button onclick="handlePlay(3)" class="bg-slate-800 h-16 rounded-2xl text-2xl font-black hover:bg-blue-600 active:scale-90 transition">3</button>
            <button onclick="handlePlay(4)" class="bg-slate-800 h-16 rounded-2xl text-2xl font-black hover:bg-blue-600 active:scale-90 transition">4</button>
            <button onclick="handlePlay(6)" class="bg-slate-800 h-16 rounded-2xl text-2xl font-black hover:bg-blue-600 active:scale-90 transition">6</button>
        </div>
        <div id="status-msg" class="mt-8 text-center text-2xl font-black h-10 italic"></div>
    </div>

    <!-- End Screen -->
    <div id="screen-result" class="hidden w-full max-w-md bg-slate-900 p-10 rounded-[3rem] text-center border border-slate-700">
        <div id="final-icon" class="text-8xl mb-4">üèÜ</div>
        <h2 id="final-title" class="text-5xl font-black mb-2 uppercase italic tracking-tighter text-green-500">VICTORY</h2>
        <p id="final-desc" class="text-slate-500 mb-10"></p>
        <button onclick="location.reload()" class="w-full bg-blue-600 py-5 rounded-3xl font-black text-xl">NEW MATCH</button>
    </div>

    <script>
        const state = {
            overs: 5, wickets: 5, innings: 1, role: 'Batting',
            userScore: 0, aiScore: 0, userWicks: 0, aiWicks: 0,
            balls: 0, target: Infinity, history: [], busy: false
        };

        const audios = {
            normal: document.getElementById('snd-normal'),
            click: document.getElementById('snd-click'),
            toss: document.getElementById('snd-toss'),
            ai: document.getElementById('snd-ai'),
            wicket: document.getElementById('snd-wicket'),
            boundary: document.getElementById('snd-boundary')
        };

        function playSound(key) {
            if (audios[key]) {
                audios[key].currentTime = 0;
                audios[key].play().catch(() => {});
            }
        }

        function initAudioAndStart() {
            audios.normal.play().catch(() => {}); // Start normal.mp3
            document.getElementById('screen-start').classList.add('hidden');
            showScreen('menu');
        }

        function showScreen(id) {
            ['menu', 'toss', 'choice', 'game', 'result'].forEach(s => document.getElementById(`screen-${s}`).classList.add('hidden'));
            document.getElementById(`screen-${id}`).classList.remove('hidden');
        }

        function setOvers(n) {
            playSound('click');
            state.overs = n; state.wickets = n;
            document.querySelectorAll('.over-btn').forEach(b => {
                b.classList.remove('border-blue-500', 'bg-blue-500/20', 'border-2');
                if(b.innerText.includes(n)) b.classList.add('border-blue-500', 'bg-blue-500/20', 'border-2');
            });
        }

        function handleMenuPlay() {
            playSound('click');
            showScreen('toss');
        }

        function handleToss(p) {
            playSound('toss');
            const res = Math.random() > 0.5 ? 'Heads' : 'Tails';
            document.getElementById('toss-status').innerText = "SPINNING...";
            setTimeout(() => {
                if (p === res) { showScreen('choice'); }
                else {
                    state.role = Math.random() > 0.5 ? 'Bowling' : 'Batting';
                    alert(`AI won and chose to ${state.role === 'Bowling' ? 'Bat' : 'Bowl'}`);
                    startGame();
                }
            }, 1000);
        }

        function setRole(r) {
            playSound('click');
            state.role = r;
            startGame();
        }

        function startGame() {
            showScreen('game');
            updateUI();
            const h = document.getElementById('user-hand');
            setInterval(() => { if(!state.busy) h.innerText = [1,2,3,4,6][Math.floor(Math.random()*5)]; }, 60);
        }

        function getAIPrediction() {
            const h = state.history;
            const l = h.length;
            if (l < 2) return null;
            if (h[l-1] === h[l-2]) return h[l-1]; // Repetition
            if (l >= 3 && h[l-1] === h[l-3]) return h[l-2]; // Alternating
            return null;
        }

        function handlePlay(val) {
            if (state.busy) return;
            state.busy = true;
            state.history.push(val);
            playSound('click');

            const pred = getAIPrediction();
            let aiVal;
            if (pred && Math.random() < 0.8) {
                aiVal = pred;
                document.getElementById('ai-alert').classList.remove('-translate-y-full');
            } else {
                aiVal = [1,2,3,4,6][Math.floor(Math.random()*5)];
                document.getElementById('ai-alert').classList.add('-translate-y-full');
            }

            document.getElementById('user-hand').innerText = val;
            document.getElementById('ai-hand').innerText = aiVal;
            state.balls++;

            const msg = document.getElementById('status-msg');

            if (val === aiVal) {
                playSound('wicket');
                msg.innerText = "OUT! üíÄ";
                msg.className = "mt-8 text-center text-2xl font-black text-red-500 italic cheer-anim";
                if (state.role === 'Batting') state.userWicks++; else state.aiWicks++;
                checkInningsSwitch();
            } else {
                const runs = state.role === 'Batting' ? val : aiVal;
                msg.innerText = `+${runs} RUNS`;
                msg.className = "mt-8 text-center text-2xl font-black text-green-500 italic";
                if (state.role === 'Batting') state.userScore += val; else state.aiScore += aiVal;
                
                if (runs >= 4) {
                    playSound('boundary');
                    triggerCheer(runs);
                } else {
                    playSound('ai'); // AI sound for normal runs
                }

                if (state.innings === 2) {
                    const batScore = state.role === 'Batting' ? state.userScore : state.aiScore;
                    if (batScore >= state.target) { endGame(); return; }
                }
                checkInningsSwitch();
            }

            updateUI();
            setTimeout(() => {
                if(!state.isOver) {
                    state.busy = false;
                    document.getElementById('ai-hand').innerText = "?";
                    msg.innerText = "";
                }
            }, 1200);
        }

        function triggerCheer(v) {
            const c = document.getElementById('cheer-container');
            const b = document.getElementById('cheer-bubble');
            const h = document.getElementById('humanoid');
            b.innerText = v === 6 ? "SIXER! üî•" : "FOUR! üëè";
            c.classList.remove('opacity-0');
            h.classList.add('cheer-anim');
            setTimeout(() => { c.classList.add('opacity-0'); h.classList.remove('cheer-anim'); }, 1500);
        }

        function checkInningsSwitch() {
            const curWicks = state.role === 'Batting' ? state.userWicks : state.aiWicks;
            if (curWicks >= state.wickets || state.balls >= state.overs * 6) {
                if (state.innings === 1) {
                    setTimeout(() => {
                        state.target = (state.role === 'Batting' ? state.userScore : state.aiScore) + 1;
                        state.innings = 2;
                        state.role = state.role === 'Batting' ? 'Bowling' : 'Batting';
                        state.balls = 0; state.history = []; state.busy = false;
                        updateUI();
                        alert(`Target Set: ${state.target}`);
                    }, 1000);
                } else { endGame(); }
            }
        }

        function updateUI() {
            const s = state.role === 'Batting' ? state.userScore : state.aiScore;
            const w = state.role === 'Batting' ? state.userWicks : state.aiWicks;
            document.getElementById('score-text').innerHTML = `${s} <span class="text-xl text-slate-500">/ ${w}</span>`;
            document.getElementById('overs-text').innerText = `${Math.floor(state.balls/6)}.${state.balls%6} / ${state.overs}`;
            document.getElementById('wickets-text').innerText = state.wickets - w;
            document.getElementById('role-badge').innerText = state.role.toUpperCase();
            document.getElementById('role-badge').className = `inline-block px-2 py-0.5 rounded text-[10px] font-black mb-1 ${state.role === 'Batting' ? 'bg-blue-600' : 'bg-red-600'}`;
            if(state.innings === 2) document.getElementById('target-text').innerText = `TARGET: ${state.target}`;
        }

        function endGame() {
            state.isOver = true;
            showScreen('result');
            const t = document.getElementById('final-title');
            const i = document.getElementById('final-icon');
            if (state.userScore > state.aiScore) { t.innerText = "CHAMPION!"; i.innerText = "üèÜ"; t.className = "text-5xl font-black mb-2 text-green-500 italic"; }
            else { t.innerText = "DEFEAT"; i.innerText = "ü§ñ"; t.className = "text-5xl font-black mb-2 text-red-500 italic"; }
            document.getElementById('final-desc').innerText = `You: ${state.userScore}/${state.userWicks} | AI: ${state.aiScore}/${state.aiWicks}`;
        }
    </script>
</body>
</html>

