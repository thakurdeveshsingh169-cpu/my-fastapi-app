<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ùïØùñäùïæùñç ùóîùê¢ Dictionary</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f6e9ef;
}

.app{
  max-width:400px;
  margin:30px auto;
  background:white;
  padding:20px;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
}

h2{
  text-align:center;
  color:#ff4f8b;
}

textarea, select{
  width:65%;
  padding:12px;
  margin:10px 0;
  border-radius:14px;
  border:1px solid #ccc;
  font-size:15px;
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:18px;
  background:#ff4f8b;
  color:white;
  font-size:16px;
  cursor:pointer;
}

.result{
  margin-top:15px;
  line-height:1.6;
}

.speakBtn{
  margin-top:8px;
  
  background:#000000;
  width: auto;
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 12px;
}

/* AI Floating Button */
#aiBtn{
  position:fixed;
  right:20px;
  bottom:20px;
  width:64px;
  height:64px;
  border-radius:18px;
  display:none;
  cursor:pointer;
  box-shadow:0 0 25px #ff00cc;
  animation:pulse 2s infinite;
}

@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.08)}
  100%{transform:scale(1)}
}

#aiExplain{
  max-width:400px;
  margin:20px auto;
  background:white;
  padding:20px;
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.2);
  display:none;
}
</style>
</head>

<body>

<div class="app">
  <h2>ùïØùñäùïæùñç Dictionary</h2>

  <textarea id="inputText" placeholder="Enter word or sentence..."></textarea>

  <select id="language">
    <option value="en">English</option>
    <option value="hi">Hindi</option>
    <option value="fr">French</option>
    <option value="es">Spanish</option>
    <option value="de">German</option>
    <option value="ta">Tamil</option>
  </select>

  <button onclick="searchDictionary()">Search Meaning</button>
  <button class="speakBtn" onclick="speakText()">üîä</button>

  <div class="result" id="result"></div>
</div>

<div id="aiExplain"></div>

<img src="logo.png" id="aiBtn" alt="DESH-AI">

<script>
const input = document.getElementById("inputText");
const result = document.getElementById("result");
const aiBtn = document.getElementById("aiBtn");
const aiExplain = document.getElementById("aiExplain");
const langSel = document.getElementById("language");

/* Speak Function */
function speak(text, lang){
  const u = new SpeechSynthesisUtterance(text);
  u.lang = lang;
  speechSynthesis.speak(u);
}

function speakText(){
  if(!input.value) return;
  speak(input.value, langSel.value);
}

/* Dictionary */
async function searchDictionary(){
  const word = input.value.trim();
  if(!word) return;

  result.innerHTML = "üîç Searching...";
  aiBtn.style.display = "none";

  try{
    const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
    const data = await res.json();

    const meaning = data[0].meanings[0];
    const def = meaning.definitions[0].definition;
    const example = meaning.definitions[0].example || "No example";

    result.innerHTML = `
      <b>Meaning:</b> ${def}<br>
      <b>Part of Speech:</b> ${meaning.partOfSpeech}<br>
      <b>Example:</b> ${example}
    `;

    aiBtn.style.display = "block";

  }catch{
    result.innerHTML = "‚ö†Ô∏è Word not found. Try translation.";
    aiBtn.style.display = "block";
  }
}

/* DESH-AI Explanation */
aiBtn.onclick = async () => {
  aiExplain.style.display = "block";

  let dots = 0;
  const loading = setInterval(()=>{
    dots=(dots+1)%4;
    aiExplain.innerText = "DESH-AI is thinking" + ".".repeat(dots);
  },500);

  const prompt = `
Explain this word/sentence in 2-3 lines:
"${input.value}"
Language: ${langSel.options[langSel.selectedIndex].text}
`;

  try{
    const res = await fetch("https://desh-ai.onrender.com/ask",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ question: prompt })
    });

    const data = await res.json();
    clearInterval(loading);

    aiExplain.innerHTML = data.answer;
    speak(data.answer, langSel.value);

  }catch{
    clearInterval(loading);
    aiExplain.innerText = "‚ö†Ô∏è DESH-AI server unreachable";
  }
};
</script>

</body>
</html>